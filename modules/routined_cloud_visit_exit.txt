[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Significant Locations - Vist Exit (Historical)

[Database Metadata]
DATABASE=Cloud.sqlite,Cloud-V2.sqlite
PLATFORMS=IOS
VERSIONS=11,12,13

[Query Metadata]
QUERY_NAME=routined_cloud_visit_exit
ACTIVITY=Location
KEY_TIMESTAMP=VISIT EXIT

[SQL Query 13]
QUERY=
   SELECT
      DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
      DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
      (ZEXITDATE-ZENTRYDATE)/60.00 AS "VISIT TIME (MINUTES)",
      ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
      ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
      ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
      ZRTADDRESSMO.ZCOUNTRY AS "COUNTRY",
      ZRTADDRESSMO.ZCOUNTRYCODE AS "COUNTRY CODE",
      ZRTADDRESSMO.ZPOSTALCODE AS "POSTAL CODE",
      ZRTADDRESSMO.ZLOCALITY AS "LOCALITY",
      ZRTADDRESSMO.ZSUBLOCALITY AS "SUBLOCALITY",
      ZRTADDRESSMO.ZTHOROUGHFARE AS "THROROUGHFARE",
      ZRTADDRESSMO.ZSUBTHOROUGHFARE AS "SUBTHOROUGHFARE",
      ZRTADDRESSMO.ZSUBADMINISTRATIVEAREA AS "SUBADMINISTRATIVE AREA",  
      ZRTADDRESSMO.ZAREASOFINTEREST AS "AREA OF INTEREST",
      ZRTADDRESSMO.ZOCEAN AS "OCEAN",
      ZRTADDRESSMO.ZINLANDWATER AS "INLAND WATER",
      ZRTADDRESSMO.ZISLAND AS "ISLAND",
      ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
      ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
      DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
      DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
      ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
      ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
      ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
      DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
      DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
      DATETIME(ZRTADDRESSMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "ADDRESS CREATION",   
      ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
      ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
      ZRTMAPITEMMO.ZLATITUDE || ", " || ZRTMAPITEMMO.ZLONGITUDE AS "MAP ITEM COORDINATES",
      DATETIME(ZRTMAPITEMMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION DATE",
      DATETIME(ZRTMAPITEMMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM EXPIRATION DATE",
      ZRTMAPITEMMO.ZLATITUDE AS "MAP ITEM LATITUTE",
      ZRTMAPITEMMO.ZLONGITUDE AS "MAP ITEM LONGITUDE",
      ZRTMAPITEMMO.ZUNCERTAINTY AS "UNCERTAINTY",
      ZRTMAPITEMMO.ZDISPLAYLANGUAGE AS "MAP ITEM LANGUAGE",
      ZRTMAPITEMMO.ZNAME AS "MAP ITEM NAME",
      HEX(ZRTMAPITEMMO.ZGEOMAPITEMHANDLE) AS "MAP ITEM GEOMAPITEM (HEX PROTOBUF)",
      ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID" 
   FROM
      ZRTLEARNEDVISITMO 
      LEFT JOIN
         ZRTDEVICEMO ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK 
      LEFT JOIN
         ZRTLEARNEDPLACEMO ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE
      LEFT JOIN
         ZRTADDRESSMO ON ZRTADDRESSMO.ZMAPITEM = ZRTLEARNEDPLACEMO.ZMAPITEM
      LEFT JOIN
         ZRTMAPITEMMO ON ZRTMAPITEMMO.Z_PK = ZRTLEARNEDPLACEMO.ZMAPITEM

[SQL Query 12]
QUERY=
   SELECT
      DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
      DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
      (ZEXITDATE-ZENTRYDATE)/60.00 AS "VISIT TIME (MINUTES)",
      ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
      ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
      ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
      ZRTADDRESSMO.ZCOUNTRY AS "COUNTRY",
      ZRTADDRESSMO.ZCOUNTRYCODE AS "COUNTRY CODE",
      ZRTADDRESSMO.ZPOSTALCODE AS "POSTAL CODE",
      ZRTADDRESSMO.ZLOCALITY AS "LOCALITY",
      ZRTADDRESSMO.ZSUBLOCALITY AS "SUBLOCALITY",
      ZRTADDRESSMO.ZTHOROUGHFARE AS "THROROUGHFARE",
      ZRTADDRESSMO.ZSUBTHOROUGHFARE AS "SUBTHOROUGHFARE",
      ZRTADDRESSMO.ZSUBADMINISTRATIVEAREA AS "SUBADMINISTRATIVE AREA",  
      ZRTADDRESSMO.ZAREASOFINTEREST AS "AREA OF INTEREST",
      ZRTADDRESSMO.ZOCEAN AS "OCEAN",
      ZRTADDRESSMO.ZINLANDWATER AS "INLAND WATER",
      ZRTADDRESSMO.ZISLAND AS "ISLAND",
      ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
      ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
      DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
      DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
      ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
      ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
      ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
      DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
      DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
      DATETIME(ZRTADDRESSMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "ADDRESS CREATION",   
      ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
      ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
      ZRTMAPITEMMO.ZLATITUDE || ", " || ZRTMAPITEMMO.ZLONGITUDE AS "MAP ITEM COORDINATES",
      DATETIME(ZRTMAPITEMMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION DATE",
      DATETIME(ZRTMAPITEMMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM EXPIRATION DATE",
      ZRTMAPITEMMO.ZLATITUDE AS "MAP ITEM LATITUTE",
      ZRTMAPITEMMO.ZLONGITUDE AS "MAP ITEM LONGITUDE",
      ZRTMAPITEMMO.ZUNCERTAINTY AS "UNCERTAINTY",
      ZRTMAPITEMMO.ZNAME AS "MAP ITEM NAME",
      HEX(ZRTMAPITEMMO.ZGEOMAPITEMHANDLE) AS "MAP ITEM GEOMAPITEM (HEX PROTOBUF)",
      ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID" 
   FROM
      ZRTLEARNEDVISITMO 
      LEFT JOIN
         ZRTDEVICEMO ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK 
      LEFT JOIN
         ZRTLEARNEDPLACEMO ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE
      LEFT JOIN
         ZRTADDRESSMO ON ZRTADDRESSMO.ZMAPITEM = ZRTLEARNEDPLACEMO.ZMAPITEM
      LEFT JOIN
         ZRTMAPITEMMO ON ZRTMAPITEMMO.Z_PK = ZRTLEARNEDPLACEMO.ZMAPITEM

[SQL Query 11]
QUERY=
	SELECT
	   DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
	   DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
      (ZEXITDATE-ZENTRYDATE)/60.00 AS "VISIT TIME (MINUTES)",
	   ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	   ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
	   ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
	   ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
	   ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
	   DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
	   DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
	   ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
	   ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
	   ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
	   DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
	   DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
	   DATETIME(ZRTLEARNEDPLACEMO.ZMAPITEMCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION",
	   HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	   HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	   ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
	   ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
	   ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID" 
	FROM
	   ZRTLEARNEDVISITMO 
	   LEFT JOIN
	      ZRTDEVICEMO 
	      ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK 
	   LEFT JOIN
	      ZRTLEARNEDPLACEMO 
	      ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE
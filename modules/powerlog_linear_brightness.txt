[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Display Brightness

[Database Metadata]
DATABASE=CurrentPowerlog.PLSQL
PLATFORM=MACOS
VERSIONS=10.15

[Query Metadata]
QUERY_NAME=powerlog_linear_brightness
ACTIVITY=Linear Brightness
KEY_TIMESTAMP=ADJUSTED_TIMESTAMP

[SQL Query 10.15]
QUERY=
	SELECT
		DATETIME(TIMESTAMP + SYSTEM, 'UNIXEPOCH') AS ADJUSTED_TIMESTAMP,
		USERBRIGHTNESS AS 'USER BRIGHTNESS',
		AUTOBRIGHTNESSENABLED AS 'AUTOBRIGHTNESS ENABLED',
		CHANGEREASON AS 'CHANGE REASON',
		DYNAMICSLIDERFACTOR AS 'DYNAMIC SLIDER FACTOR',
		LINEARBRIGHTNESS AS 'LINEAR BRIGHTNESS',
		LINEARBRIGHTNESSDYNAMICSLIDER AS 'LINEAR BRIGHTNESS DYNAMIC SLIDER',
		MAGSAFEREDUCTIONFACTOR AS 'MAGSAFE REDUCTION FACTOR',
		DATETIME(TIMESTAMP, 'UNIXEPOCH') AS ORIGINAL_TIMESTAMP,
		DATETIME(TIME_OFFSET_TIMESTAMP, 'UNIXEPOCH') AS OFFSET_TIMESTAMP,
		SYSTEM AS TIME_OFFSET,
		TABLE_ID AS "PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS TABLE ID"
	FROM
	(
	SELECT
		TABLE_ID,
		TIMESTAMP,
		TIME_OFFSET_TIMESTAMP,
		MAX(TIME_OFFSET_ID) AS MAX_ID,
		USERBRIGHTNESS,
		AUTOBRIGHTNESSENABLED,
		CHANGEREASON,
		DYNAMICSLIDERFACTOR,
		LINEARBRIGHTNESS,
		LINEARBRIGHTNESSDYNAMICSLIDER,
		MAGSAFEREDUCTIONFACTOR,
		SYSTEM
	FROM
	(
	SELECT
		PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS.TIMESTAMP,
		PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS.USERBRIGHTNESS,
		PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS.AUTOBRIGHTNESSENABLED,
		PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS.CHANGEREASON,
		PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS.DYNAMICSLIDERFACTOR,
		PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS.LINEARBRIGHTNESS,
		PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS.LINEARBRIGHTNESSDYNAMICSLIDER,
		PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS.MAGSAFEREDUCTIONFACTOR,
		PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS.ID AS "TABLE_ID",
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
		PLDISPLAYAGENT_EVENTFORWARD_LINEARBRIGHTNESS 
	LEFT JOIN
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET 
	)
	GROUP BY
	TABLE_ID 
         )
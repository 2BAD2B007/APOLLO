[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Application Usage, shows application in focus on device.

[Database Metadata]
DATABASE=knowledgeC.db
PLATFORM=IOS,MACOS
VERSIONS=11,12,13,10.13,10.14,10.15

[Query Metadata]
QUERY_NAME=knowledge_app_inFocus
ACTIVITY=Application In Focus
KEY_TIMESTAMP=START

[SQL Query 12,13,10.13,10.14,10.15]
QUERY=
	SELECT
		DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') AS "START", 
		DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') AS "END",
		ZOBJECT.ZVALUESTRING AS "BUNDLE ID", 
		ZSTRUCTUREDMETADATA .Z_DKAPPLICATIONMETADATAKEY__LAUNCHREASON AS "LAUNCH REASON",
		(ZOBJECT.ZENDDATE-ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
		(ZOBJECT.ZENDDATE-ZOBJECT.ZSTARTDATE)/60.00 AS "USAGE IN MINUTES",
		CASE ZOBJECT.ZSTARTDAYOFWEEK 
		    WHEN "1" THEN "Sunday"
		    WHEN "2" THEN "Monday"
		    WHEN "3" THEN "Tuesday"
		    WHEN "4" THEN "Wednesday"
		    WHEN "5" THEN "Thursday"
		    WHEN "6" THEN "Friday"
		    WHEN "7" THEN "Saturday"
		END "DAY OF WEEK",
		ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
		DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') AS "ENTRY CREATION",
		ZOBJECT.ZUUID AS "UUID",	
		ZOBJECT.Z_PK AS "ZOBJECT TABLE ID" 
	FROM ZOBJECT
	LEFT JOIN
         ZSTRUCTUREDMETADATA 
         ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK 
	WHERE ZSTREAMNAME IS "/app/inFocus"

[SQL Query 11]
QUERY=
	SELECT
		DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') AS "START", 
		DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') AS "END",
		ZOBJECT.ZVALUESTRING AS "BUNDLE ID", 
		(ZOBJECT.ZENDDATE-ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
		(ZOBJECT.ZENDDATE-ZOBJECT.ZSTARTDATE)/60.00 AS "USAGE IN MINUTES",
		CASE ZOBJECT.ZSTARTDAYOFWEEK 
		    WHEN "1" THEN "Sunday"
		    WHEN "2" THEN "Monday"
		    WHEN "3" THEN "Tuesday"
		    WHEN "4" THEN "Wednesday"
		    WHEN "5" THEN "Thursday"
		    WHEN "6" THEN "Friday"
		    WHEN "7" THEN "Saturday"
		END "DAY OF WEEK",
		ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
		DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') AS "ENTRY CREATION",	
		ZOBJECT.Z_PK AS "ZOBJECT TABLE ID" 
	FROM ZOBJECT
	WHERE ZSTREAMNAME IS "/app/inFocus"
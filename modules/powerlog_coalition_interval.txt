[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=App Coalition Information

[Database Metadata]
DATABASE=CurrentPowerlog.PLSQL
PLATFORM=MACOS
VERSIONS=10.15

[Query Metadata]
QUERY_NAME=powerlog_coalition_interval
ACTIVITY=Coalition Interval
KEY_TIMESTAMP=ADJUSTED_TIMESTAMP

[SQL Query 10.14,10.15]
QUERY=
	SELECT
		DATETIME(TIMESTAMP + SYSTEM, 'UNIXEPOCH') AS ADJUSTED_TIMESTAMP,
		BUNDLEID AS 'BUNDLE ID',
		LAUNCHDCOALITIONID AS 'LAUNCHD COALITION ID',
		LAUNCHDNAME AS 'LAUNCHD NAME',
		BYTESREAD AS 'BYTES READ',
		BYTESWRITTEN AS 'BYTES WRITTEN',
		CPU_INSTRUCTIONS AS 'CPU INSTRUCITONS',
		CPU_TIME AS 'CPU TIME',
		GPU_TIME AS 'GPU TIME',
		TASKS_STARTED AS 'TASKS STARTED',
		TASKS_EXITED AS 'TASKS EXITED',
		DATETIME(TIMESTAMPEND + SYSTEM, 'UNIXEPOCH') AS ADJUSTED_END_TIMESTAMP,
		DATETIME(TIMESTAMP, 'UNIXEPOCH') AS ORIGINAL_TIMESTAMP,
		DATETIME(TIME_OFFSET_TIMESTAMP, 'UNIXEPOCH') AS OFFSET_TIMESTAMP,
		SYSTEM AS TIME_OFFSET,
		TABLE_ID AS "PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL TABLE ID"
	FROM
	(
	SELECT
		TABLE_ID,
		TIMESTAMP,
		TIME_OFFSET_TIMESTAMP,
		MAX(TIME_OFFSET_ID) AS MAX_ID,
		TIMESTAMPEND,
		BUNDLEID,
		LAUNCHDCOALITIONID,
		LAUNCHDNAME,
		BYTESREAD,
		BYTESWRITTEN,
		CPU_INSTRUCTIONS,
		CPU_TIME,
		GPU_TIME,
		TASKS_STARTED,
		TASKS_EXITED,
		SYSTEM
	FROM
	(
	SELECT
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.TIMESTAMP,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.TIMESTAMPEND,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.BUNDLEID,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.LAUNCHDCOALITIONID,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.LAUNCHDNAME,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.BYTESREAD,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.BYTESWRITTEN,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.CPU_INSTRUCTIONS,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.CPU_TIME,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.GPU_TIME,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.TASKS_STARTED,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.TASKS_EXITED,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.ID AS "TABLE_ID",
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL 
	LEFT JOIN
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET 
	)
	GROUP BY
	TABLE_ID 
         )

[SQL Query 10.14]
QUERY=
	SELECT
		DATETIME(TIMESTAMP + SYSTEM, 'UNIXEPOCH') AS ADJUSTED_TIMESTAMP,
		BUNDLEID AS 'BUNDLE ID',
		LAUNCHDCOALITIONID AS 'LAUNCHD COALITION ID',
		LAUNCHDNAME AS 'LAUNCHD NAME',
		BYTESREAD AS 'BYTES READ',
		BYTESWRITTEN AS 'BYTES WRITTEN',
		CPU_TIME AS 'CPU TIME',
		GPU_TIME AS 'GPU TIME',
		TASKS_STARTED AS 'TASKS STARTED',
		TASKS_EXITED AS 'TASKS EXITED',
		DATETIME(TIMESTAMPEND + SYSTEM, 'UNIXEPOCH') AS ADJUSTED_END_TIMESTAMP,
		DATETIME(TIMESTAMP, 'UNIXEPOCH') AS ORIGINAL_TIMESTAMP,
		DATETIME(TIME_OFFSET_TIMESTAMP, 'UNIXEPOCH') AS OFFSET_TIMESTAMP,
		SYSTEM AS TIME_OFFSET,
		TABLE_ID AS "PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL TABLE ID"
	FROM
	(
	SELECT
		TABLE_ID,
		TIMESTAMP,
		TIME_OFFSET_TIMESTAMP,
		MAX(TIME_OFFSET_ID) AS MAX_ID,
		TIMESTAMPEND,
		BUNDLEID,
		LAUNCHDCOALITIONID,
		LAUNCHDNAME,
		BYTESREAD,
		BYTESWRITTEN,
		CPU_TIME,
		GPU_TIME,
		TASKS_STARTED,
		TASKS_EXITED,
		SYSTEM
	FROM
	(
	SELECT
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.TIMESTAMP,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.TIMESTAMPEND,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.BUNDLEID,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.LAUNCHDCOALITIONID,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.LAUNCHDNAME,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.BYTESREAD,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.BYTESWRITTEN,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.CPU_TIME,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.GPU_TIME,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.TASKS_STARTED,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.TASKS_EXITED,
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL.ID AS "TABLE_ID",
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
		PLCOALITIONAGENT_EVENTINTERVAL_COALITIONINTERVAL 
	LEFT JOIN
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET 
	)
	GROUP BY
	TABLE_ID 
         )



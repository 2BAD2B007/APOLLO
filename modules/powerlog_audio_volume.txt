[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Device Volume

[Database Metadata]
DATABASE=CurrentPowerlog.PLSQL
PLATFORM=MACOS
VERSIONS=10.15

[Query Metadata]
QUERY_NAME=powerlog_audio_volume
ACTIVITY=Audio Volume
KEY_TIMESTAMP=ADJUSTED_TIMESTAMP

[SQL Query 10.15]
QUERY=
	SELECT
		DATETIME(TIMESTAMP + SYSTEM, 'UNIXEPOCH') AS ADJUSTED_TIMESTAMP,
		DEVICEID AS 'DEVICE ID',
		ISINPUT AS 'IS INPUT',
		ISRUNNING AS 'IS RUNNING',
		SOURCEID  AS 'SOURCE ID',
		TRANSTYPE AS 'TRANS TYPE',
		VOLUME AS 'VOLUME',
		DATETIME(TIMESTAMPLOGGED + SYSTEM, 'UNIXEPOCH') AS ADJUSTED_LOGGED_TIMESTAMP,
		DATETIME(TIMESTAMP, 'UNIXEPOCH') AS ORIGINAL_TIMESTAMP,
		DATETIME(TIME_OFFSET_TIMESTAMP, 'UNIXEPOCH') AS OFFSET_TIMESTAMP,
		SYSTEM AS TIME_OFFSET,
		TABLE_ID AS "PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE TABLE ID"
	FROM
	(
	SELECT
		TABLE_ID,
		TIMESTAMP,
		TIME_OFFSET_TIMESTAMP,
		MAX(TIME_OFFSET_ID) AS MAX_ID,
		TIMESTAMPLOGGED,
		DEVICEID,
		ISINPUT,
		ISRUNNING,
		SOURCEID,
		TRANSTYPE,
		VOLUME,
		SYSTEM
	FROM
	(
	SELECT
		PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE.TIMESTAMP,
		PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE.TIMESTAMPLOGGED,
		PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE.DEVICEID,
		PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE.ISINPUT,
		PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE.ISRUNNING,
		PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE.SOURCEID,
		PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE.TRANSTYPE,
		PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE.VOLUME,
		PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE.ID AS "TABLE_ID",
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
		PLAUDIOAGENT_EVENTFORWARD_AUDIODEVICE 
	LEFT JOIN
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET 
	)
	GROUP BY
	TABLE_ID 
         )
[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Significant Locations - Inbound Stop (Historical)

[Database Metadata]
DATABASE=Cloud.sqlite
PLATFORMS=IOS
VERSIONS=11

[Query Metadata]
QUERY_NAME=routined_cloud_visit_inbound_stop
ACTIVITY=Location
KEY_TIMESTAMP=INBOUND STOP DATE

[SQL Query]
QUERY=
	SELECT
	   DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTARTDATE + 978307200, 'unixepoch') AS "INBOUND START DATE",
	   DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTOPDATE + 978307200, 'unixepoch') AS "INBOUND STOP DATE",
	   ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	   ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
	   ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
	   ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
	   ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
	   DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
	   DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
	   DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
	   DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
	   ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
	   ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
	   ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
	   DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
	   DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
	   DATETIME(ZRTLEARNEDPLACEMO.ZMAPITEMCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION",
	   HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	   HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	   ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
	   ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
	   ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID" 
	FROM
	   ZRTLEARNEDVISITMO 
	   LEFT JOIN
	      ZRTDEVICEMO 
	      ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK 
	   LEFT JOIN
	      ZRTLEARNEDPLACEMO 
	      ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE 
	   LEFT JOIN
	      ZRTLEARNEDTRANSITIONMO 
	      ON ZRTLEARNEDTRANSITIONMO.Z_PK = ZRTLEARNEDVISITMO.ZINBOUND
      WHERE "INBOUND START DATE" NOT NULL
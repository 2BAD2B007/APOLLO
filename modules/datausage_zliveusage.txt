[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Data Usage Traffic by Process. Can also be used on DataUsage-watch.sqlite

[Database Metadata]
DATABASE=DataUsage.sqlite
PLATFORMS=IOS
VERSIONS=8,9,10,11,12

[Query Metadata]
QUERY_NAME=datausage_zliveusage
ACTIVITY=Data Usage
KEY_TIMESTAMP=TIMESTAMP

[SQL Query]
QUERY=
	SELECT
		DATETIME(ZLIVEUSAGE.ZTIMESTAMP + 978307200, 'unixepoch') AS "TIMESTAMP",
		DATETIME(ZPROCESS.ZFIRSTTIMESTAMP + 978307200, 'unixepoch') AS "PROCESS FIRST TIMESTAMP",
		DATETIME(ZPROCESS.ZTIMESTAMP+ 978307200, 'unixepoch') AS "PROCESS TIMESTAMP",
		ZPROCESS.ZPROCNAME AS "PROCESS NAME",
		ZPROCESS.ZBUNDLENAME AS "BUNDLE ID",
		ZLIVEUSAGE.ZWIFIIN AS "WIFI IN",
		ZLIVEUSAGE.ZWIFIOUT AS "WIFI OUT",
		ZLIVEUSAGE.ZWWANIN AS "WWAN IN",
		ZLIVEUSAGE.ZWWANOUT AS "WWAN OUT",
		ZLIVEUSAGE.Z_PK AS "ZLIVEUSAGE TABLE ID" 
	FROM ZLIVEUSAGE
	LEFT JOIN ZPROCESS ON ZLIVEUSAGE.ZHASPROCESS = ZPROCESS.Z_PK
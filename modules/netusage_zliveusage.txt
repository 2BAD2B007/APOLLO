[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Network Usage Traffic by Process.

[Database Metadata]
DATABASE=netusage.sqlite
PLATFORMS=IOS
VERSIONS=8,9,10,11

[Query Metadata]
QUERY_NAME=netusage_zliveusage
ACTIVITY=Network Usage
KEY_TIMESTAMP=PROCESS TIMESTAMP

[SQL Query 10,11]
QUERY=
    SELECT
        DATETIME(ZPROCESS.ZTIMESTAMP + 978307200, 'unixepoch') AS "PROCESS TIMESTAMP",
        DATETIME(ZPROCESS.ZFIRSTTIMESTAMP + 978307200, 'unixepoch') AS "PROCESS FIRST TIMESTAMP",
        DATETIME(ZLIVEUSAGE.ZTIMESTAMP + 978307200, 'unixepoch') AS "LIVE USAGE TIMESTAMP",
        ZBUNDLENAME AS "BUNDLE ID",
        ZPROCNAME AS "PROCESS NAME",
        ZWIFIIN AS "WIFI IN",
        ZWIFIOUT AS "WIFI OUT",
        ZWWANIN AS "WWAN IN",
        ZWWANOUT AS "WWAN OUT",
        ZWIREDIN AS "WIRED IN",
        ZWIREDOUT AS "WIRED OUT",
        ZXIN AS "X IN",
        ZXOUT AS "X OUT",
        ZLIVEUSAGE.Z_PK AS "ZLIVEUSAGE TABLE ID" 
    FROM ZLIVEUSAGE 
    LEFT JOIN ZPROCESS ON ZPROCESS.Z_PK = ZLIVEUSAGE.ZHASPROCESS

[SQL Query 8,9]
QUERY=
    SELECT
        DATETIME(ZPROCESS.ZTIMESTAMP + 978307200, 'unixepoch') AS "PROCESS TIMESTAMP",
        DATETIME(ZPROCESS.ZFIRSTTIMESTAMP + 978307200, 'unixepoch') AS "PROCESS FIRST TIMESTAMP",
        DATETIME(ZLIVEUSAGE.ZTIMESTAMP + 978307200, 'unixepoch') AS "LIVE USAGE TIMESTAMP",
        ZBUNDLENAME AS "BUNDLE ID",
        ZPROCNAME AS "PROCESS NAME",
        ZWIFIIN AS "WIFI IN",
        ZWIFIOUT AS "WIFI OUT",
        ZWWANIN AS "WWAN IN",
        ZWWANOUT AS "WWAN OUT",
        ZWIREDIN AS "WIRED IN",
        ZWIREDOUT AS "WIRED OUT",
        ZLIVEUSAGE.Z_PK AS "ZLIVEUSAGE TABLE ID" 
    FROM ZLIVEUSAGE 
    LEFT JOIN ZPROCESS ON ZPROCESS.Z_PK = ZLIVEUSAGE.ZHASPROCESS
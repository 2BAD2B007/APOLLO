[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Screen Time - App (By Hour)

[Database Metadata]
DATABASE=RMAdminStore-Local.sqlite,RMAdminStore-Cloud.sqlite
PLATFORM=IOS,MACOS
VERSIONS=12,13,10.15

[Query Metadata]
QUERY_NAME=screentime_timed_items
ACTIVITY=Screen Time - App (By Hour)
KEY_TIMESTAMP=HOUR

[SQL Query 13,10.15]
QUERY=
	SELECT 
		DATETIME(ZUSAGEBLOCK.ZSTARTDATE+978307200,'UNIXEPOCH') AS 'HOUR',
		ZUSAGETIMEDITEM.ZBUNDLEIDENTIFIER AS  'BUNDLE ID',
		ZUSAGETIMEDITEM.ZDOMAIN AS 'DOMAIN',
		CASE ZUSAGECATEGORY.ZIDENTIFIER 
			WHEN 'DH0011' THEN 'Unspecified1'
			WHEN 'DH0012' THEN 'Unspecified2'
			WHEN 'DH0013' THEN 'Unspecified3'
			WHEN 'DH1001' THEN 'Games'
			WHEN 'DH1002' THEN 'Social Networking'
			WHEN 'DH1003' THEN 'Entertainment'
			WHEN 'DH1004' THEN 'Creativity'
			WHEN 'DH1005' THEN 'Productivity'
			WHEN 'DH1006' THEN 'Education'
			WHEN 'DH1007' THEN 'Reading & Reference'
			WHEN 'DH1008' THEN 'Health & Fitness'
			WHEN 'DH1009' THEN 'Other'
			ELSE ZUSAGECATEGORY.ZIDENTIFIER
		END AS 'CATEGORY ID',
		ZUSAGETIMEDITEM.ZTOTALTIMEINSECONDS  AS 'APP USAGE TIME ITEM (SECONDS)',	
		ZUSAGETIMEDITEM.ZTOTALTIMEINSECONDS/60.00 AS 'APP USAGE TIME ITEM (MINUTES)',	
		ZUSAGEBLOCK.ZNUMBEROFPICKUPSWITHOUTAPPLICATIONUSAGE AS 'NUMBER OF PICKUPS W/O APP USAGE',	
		ZCOREDEVICE.ZNAME AS 'NAME',
		ZCOREDEVICE.ZIDENTIFIER AS 'DEVICE ID',
		ZCOREDEVICE.ZLOCALUSERDEVICESTATE AS 'LOCAL USER DEVICE STATE',
		CASE ZCOREDEVICE.ZPLATFORM
			WHEN 0 THEN 'Unknown'
			WHEN 1 THEN 'macOS'
			WHEN 2 THEN 'iOS'
			WHEN 4 THEN 'Apple Watch'
			ELSE ZPLATFORM
		END AS PLATFORM,
		ZCOREUSER.ZGIVENNAME AS 'GIVEN NAME',
		ZCOREUSER.ZFAMILYNAME AS 'FAMILY NAME',
		ZCOREUSER.ZFAMILYMEMBERTYPE AS 'FAMILY MEMBER TYPE',
		ZCOREUSER.ZAPPLEID AS 'APPLE ID',
		ZCOREUSER.ZDSID AS 'DSID',
		ZCOREUSER.ZALTDSID AS 'ALT DSID',
		ZUSAGETIMEDITEM.Z_PK AS 'ZUSAGETIMEDITEM TABLE ID'
	FROM ZUSAGETIMEDITEM
	LEFT JOIN ZUSAGECATEGORY ON ZUSAGECATEGORY.Z_PK == ZUSAGETIMEDITEM.ZCATEGORY
	LEFT JOIN ZUSAGEBLOCK ON ZUSAGECATEGORY.ZBLOCK == ZUSAGEBLOCK.Z_PK
	LEFT JOIN ZUSAGE ON ZUSAGEBLOCK.ZUSAGE == ZUSAGE.Z_PK
	LEFT JOIN ZCOREUSER ON ZUSAGE.ZUSER == ZCOREUSER.Z_PK
	LEFT JOIN ZCOREDEVICE ON ZUSAGE.ZDEVICE == ZCOREDEVICE.Z_PK

[SQL Query 12]
	SELECT 
		DATETIME(ZUSAGEBLOCK.ZSTARTDATE+978307200,'UNIXEPOCH') AS 'HOUR',
		ZUSAGETIMEDITEM.ZBUNDLEIDENTIFIER AS  'BUNDLE ID',
		ZUSAGETIMEDITEM.ZDOMAIN AS 'DOMAIN',
		CASE ZUSAGECATEGORY.ZIDENTIFIER 
			WHEN 'DH0011' THEN 'Unspecified1'
			WHEN 'DH0012' THEN 'Unspecified2'
			WHEN 'DH0013' THEN 'Unspecified3'
			WHEN 'DH1001' THEN 'Games'
			WHEN 'DH1002' THEN 'Social Networking'
			WHEN 'DH1003' THEN 'Entertainment'
			WHEN 'DH1004' THEN 'Creativity'
			WHEN 'DH1005' THEN 'Productivity'
			WHEN 'DH1006' THEN 'Education'
			WHEN 'DH1007' THEN 'Reading & Reference'
			WHEN 'DH1008' THEN 'Health & Fitness'
			WHEN 'DH1009' THEN 'Other'
			ELSE ZUSAGECATEGORY.ZIDENTIFIER
		END AS 'CATEGORY ID',
		ZUSAGETIMEDITEM.ZTOTALTIMEINSECONDS  AS 'APP USAGE TIME ITEM (SECONDS)',	
		ZUSAGETIMEDITEM.ZTOTALTIMEINSECONDS/60.00 AS 'APP USAGE TIME ITEM (MINUTES)',	
		ZUSAGEBLOCK.ZNUMBEROFPICKUPSWITHOUTAPPLICATIONUSAGE AS 'NUMBER OF PICKUPS W/O APP USAGE',	
		ZCOREDEVICE.ZNAME AS 'NAME',
		ZCOREDEVICE.ZIDENTIFIER AS 'DEVICE ID',
		ZCOREDEVICE.ZLOCALUSERDEVICESTATE AS 'LOCAL USER DEVICE STATE',
		ZCOREUSER.ZGIVENNAME AS 'GIVEN NAME',
		ZCOREUSER.ZFAMILYNAME AS 'FAMILY NAME',
		ZCOREUSER.ZFAMILYMEMBERTYPE AS 'FAMILY MEMBER TYPE',
		ZCOREUSER.ZAPPLEID AS 'APPLE ID',
		ZCOREUSER.ZDSID AS 'DSID',
		ZUSAGETIMEDITEM.Z_PK AS 'ZUSAGETIMEDITEM TABLE ID'
	FROM ZUSAGETIMEDITEM
	LEFT JOIN ZUSAGECATEGORY ON ZUSAGECATEGORY.Z_PK == ZUSAGETIMEDITEM.ZCATEGORY
	LEFT JOIN ZUSAGEBLOCK ON ZUSAGECATEGORY.ZBLOCK == ZUSAGEBLOCK.Z_PK
	LEFT JOIN ZUSAGE ON ZUSAGEBLOCK.ZUSAGE == ZUSAGE.Z_PK
	LEFT JOIN ZCOREUSER ON ZUSAGE.ZUSER == ZCOREUSER.Z_PK
	LEFT JOIN ZCOREDEVICE ON ZUSAGE.ZDEVICE == ZCOREDEVICE.Z_PK
[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Wallet Transactions

[Database Metadata]
DATABASE=passes23.sqlite
PLATFORM=IOS
VERSIONS=10,11,12,13

[Query Metadata]
QUERY_NAME=passes23_wallet_transactions
ACTIVITY=Wallet Transaction
KEY_TIMESTAMP=TRANSACTION DATE

[SQL Query 10,11,12,13]
QUERY=
	SELECT
		DATETIME(PASS.INGESTED_DATE+978307200,'UNIXEPOCH') AS "INGESTED DATE",
		DATETIME(PASS.MODIFIED_DATE+978307200,'UNIXEPOCH') AS "MODIFIED DATE",
		DATETIME(PAYMENT_TRANSACTION.TRANSACTION_DATE+978307200,'UNIXEPOCH') AS "TRANSACTION DATE",
		PASS.ORGANIZATION_NAME AS "ORGANIZATION NAME",
		PASS_TYPE.IDENTIFIER AS "IDENTIFIER",
		PAYMENT_TRANSACTION.AMOUNT/100.00 AS "AMOUNT",
		PAYMENT_TRANSACTION.CURRENCY_CODE AS "CURRENCY CODE",
		PAYMENT_TRANSACTION.MERCHANT_INDUSTRY_CATEGORY AS "MERCHANT INDUSTRY CATEGORY",
		PAYMENT_TRANSACTION.MERCHANT_NAME AS "MERCHANT NAME",
		PAYMENT_TRANSACTION.MERCHANT_INDUSTRY_CATEGORY AS "MERCHANT CATEGORY",
		PAYMENT_TRANSACTION.PEER_PAYMENT_COUNTERPART_HANDLE AS "PEER PAYMENT HANDLE",
		PAYMENT_TRANSACTION.PEER_PAYMENT_MEMO AS "PEER PAYMENT MEMO",
		DATETIME(PAYMENT_TRANSACTION.LOCATION_DATE+978307200,'UNIXEPOCH') AS "LOCATION DATE",
		PAYMENT_TRANSACTION.LOCATION_LATITUDE AS "LATITUDE",
		PAYMENT_TRANSACTION.LOCATION_LONGITUDE AS "LONGITUDE",
		PAYMENT_TRANSACTION.LOCATION_ALTITUDE AS "ALTITUDE",
		PAYMENT_TRANSACTION.LOCATION_HORIZONTAL_ACCURACY AS "HORIZONTAL ACCURACY",
		PAYMENT_TRANSACTION.LOCATION_VERTICAL_ACCURACY AS "VERTICAL ACCURACY",
		SERIAL_NUMBER AS "SERIAL NUMBER",
		PASS.UNIQUE_ID AS "PASS ID"
	FROM PASS
	LEFT JOIN PASS_TYPE ON PASS.PASS_TYPE_PID == PASS_TYPE.PID
	LEFT JOIN PAYMENT_TRANSACTION ON PASS.PID == PAYMENT_TRANSACTION.PASS_PID
	LEFT JOIN LOCATION_SOURCE ON LOCATION_SOURCE.URL LIKE '%'||PASS.UNIQUE_ID||'%'
	LEFT JOIN LOCATION ON LOCATION.LOCATION_SOURCE_PID == LOCATION_SOURCE.PID
	WHERE "AMOUNT" NOT NULL
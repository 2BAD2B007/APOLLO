[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Video Session Information

[Database Metadata]
DATABASE=CurrentPowerlog.PLSQL
PLATFORM=MACOS
VERSIONS=10.15

[Query Metadata]
QUERY_NAME=powerlog_video_vtsession
ACTIVITY=Video VT Session
KEY_TIMESTAMP=ADJUSTED_TIMESTAMP

[SQL Query 10.15]
QUERY=
	SELECT
		DATETIME(TIMESTAMP + SYSTEM, 'UNIXEPOCH') AS ADJUSTED_TIMESTAMP,
		ISHDR AS 'IS HDR',
		LOGID AS 'LOG ID',
		NUMFRAMESDECODED AS 'NUM FRAMES DECODED',
		NUMFRAMESDROPPED AS 'NUM FRAMES DROPPED',
		PROCESSID AS 'PROCESS ID',
		RESHEIGHT AS 'RES HEIGHT',
		RESWIDTH AS 'RES WIDTH',
		SESSIONDURATION AS 'SESSION DURATION', 
		VIDEOCODECTYPE AS 'VIDEO CODEC TYPE',
		DATETIME(TIMESTAMP, 'UNIXEPOCH') AS ORIGINAL_TIMESTAMP,
		DATETIME(TIME_OFFSET_TIMESTAMP, 'UNIXEPOCH') AS OFFSET_TIMESTAMP,
		SYSTEM AS TIME_OFFSET,
		TABLE_ID AS "PLVIDEOAGENT_EVENTBACKWARD_VTSESSION TABLE ID"
	FROM
	(
	SELECT
		TABLE_ID,
		TIMESTAMP,
		TIME_OFFSET_TIMESTAMP,
		MAX(TIME_OFFSET_ID) AS MAX_ID,
		ISHDR,
		LOGID,
		NUMFRAMESDECODED,
		NUMFRAMESDROPPED,
		PROCESSID,
		RESHEIGHT,
		RESWIDTH,
		SESSIONDURATION,
		VIDEOCODECTYPE,
		SYSTEM
	FROM
	(
	SELECT
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.TIMESTAMP,
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.ISHDR,
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.LOGID,
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.NUMFRAMESDECODED,
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.NUMFRAMESDROPPED,
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.PROCESSID,
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.RESHEIGHT,
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.RESWIDTH,
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.SESSIONDURATION,
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.VIDEOCODECTYPE,
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION.ID AS "TABLE_ID",
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
		PLVIDEOAGENT_EVENTBACKWARD_VTSESSION 
	LEFT JOIN
		PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET 
	)
	GROUP BY
	TABLE_ID 
         )
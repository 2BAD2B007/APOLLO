[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Screen Time - Counted Items - This includes notifications and pickups.

[Database Metadata]
DATABASE=RMAdminStore-Local.sqlite,RMAdminStore-Cloud.sqlite
PLATFORM=IOS,MACOS
VERSIONS=12,13,10.15

[Query Metadata]
QUERY_NAME=screentime_counted_items
ACTIVITY=Screen Time - Counted Item
KEY_TIMESTAMP=HOUR

[SQL Query 13,10.15]
QUERY=
	SELECT 
		DATETIME(ZUSAGEBLOCK.ZSTARTDATE+978307200,'UNIXEPOCH') AS 'HOUR',
		ZUSAGECOUNTEDITEM.ZBUNDLEIDENTIFIER AS 'BUNDLE ID', 
		ZUSAGECOUNTEDITEM.ZNUMBEROFNOTIFICATIONS AS 'NUMBER OF NOTIFICATIONS',
		ZUSAGECOUNTEDITEM.ZNUMBEROFPICKUPS AS 'NUMBER OF PICKUPS',
		DATETIME(ZUSAGEBLOCK.ZFIRSTPICKUPDATE+978307200,'UNIXEPOCH') AS 'FIRST PICKUP',
		ZUSAGEBLOCK.ZNUMBEROFPICKUPSWITHOUTAPPLICATIONUSAGE AS 'NUMBER OF PICKUPS W/O APP USAGE',
		ZCOREDEVICE.ZNAME AS 'NAME',
		ZCOREDEVICE.ZIDENTIFIER AS 'DEVICE ID',
		ZCOREDEVICE.ZLOCALUSERDEVICESTATE AS 'LOCAL USER DEVICE STATE',
		CASE ZCOREDEVICE.ZPLATFORM
			WHEN 0 THEN 'Unknown'
			WHEN 1 THEN 'macOS'
			WHEN 2 THEN 'iOS'
			WHEN 4 THEN 'Apple Watch'
			ELSE ZPLATFORM
		END AS PLATFORM,
		ZCOREUSER.ZGIVENNAME AS 'GIVEN NAME',
		ZCOREUSER.ZFAMILYNAME AS 'FAMILY NAME',
		ZCOREUSER.ZFAMILYMEMBERTYPE AS 'FAMILY MEMBER TYPE',
		ZCOREUSER.ZAPPLEID AS 'APPLE ID',
		ZCOREUSER.ZDSID AS 'DSID',
		ZCOREUSER.ZALTDSID AS 'ALT DSID',
		ZUSAGECOUNTEDITEM.Z_PK AS "ZUSAGECOUNTEDITEM TABLE ID"
	FROM ZUSAGECOUNTEDITEM
	LEFT JOIN ZUSAGEBLOCK ON ZUSAGECOUNTEDITEM.ZBLOCK == ZUSAGEBLOCK.Z_PK
	LEFT JOIN ZUSAGE ON ZUSAGEBLOCK.ZUSAGE == ZUSAGE.Z_PK
	LEFT JOIN ZCOREUSER ON ZUSAGE.ZUSER == ZCOREUSER.Z_PK
	LEFT JOIN ZCOREDEVICE ON ZUSAGE.ZDEVICE == ZCOREDEVICE.Z_PK

[SQL Query 12]
QUERY=
	SELECT 
		DATETIME(ZUSAGEBLOCK.ZSTARTDATE+978307200,'UNIXEPOCH') AS 'HOUR',
		ZUSAGECOUNTEDITEM.ZBUNDLEIDENTIFIER AS 'BUNDLE ID', 
		ZUSAGECOUNTEDITEM.ZNUMBEROFNOTIFICATIONS AS 'NUMBER OF NOTIFICATIONS',
		ZUSAGECOUNTEDITEM.ZNUMBEROFPICKUPS AS 'NUMBER OF PICKUPS',
		DATETIME(ZUSAGEBLOCK.ZFIRSTPICKUPDATE+978307200,'UNIXEPOCH') AS 'FIRST PICKUP',
		ZUSAGEBLOCK.ZNUMBEROFPICKUPSWITHOUTAPPLICATIONUSAGE AS 'NUMBER OF PICKUPS W/O APP USAGE',
		ZCOREDEVICE.ZNAME AS 'NAME',
		ZCOREDEVICE.ZIDENTIFIER AS 'DEVICE ID',
		ZCOREDEVICE.ZLOCALUSERDEVICESTATE AS 'LOCAL USER DEVICE STATE',
		ZCOREUSER.ZGIVENNAME AS 'GIVEN NAME',
		ZCOREUSER.ZFAMILYNAME AS 'FAMILY NAME',
		ZCOREUSER.ZFAMILYMEMBERTYPE AS 'FAMILY MEMBER TYPE',
		ZCOREUSER.ZAPPLEID AS 'APPLE ID',
		ZCOREUSER.ZDSID AS 'DSID',
		ZUSAGECOUNTEDITEM.Z_PK AS "ZUSAGECOUNTEDITEM TABLE ID"
	FROM ZUSAGECOUNTEDITEM
	LEFT JOIN ZUSAGEBLOCK ON ZUSAGECOUNTEDITEM.ZBLOCK == ZUSAGEBLOCK.Z_PK
	LEFT JOIN ZUSAGE ON ZUSAGEBLOCK.ZUSAGE == ZUSAGE.Z_PK
	LEFT JOIN ZCOREUSER ON ZUSAGE.ZUSER == ZCOREUSER.Z_PK
	LEFT JOIN ZCOREDEVICE ON ZUSAGE.ZDEVICE == ZCOREDEVICE.Z_PK

[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Transparancy, Consent, and Control (TCC) Database - Application Permissions

[Database Metadata]
DATABASE=TCC.db
PLATFORM=MACOS
VERSIONS=10.14,10.15

[Query Metadata]
QUERY_NAME=tcc_db
ACTIVITY=App Permissions
KEY_TIMESTAMP=LAST MODIFIED

[SQL Query 12,13,10.14,10.15]
QUERY=
	SELECT 
		DATETIME(LAST_MODIFIED,'UNIXEPOCH') AS "LAST MODIFIED",
		SERVICE AS 'SERVICE',
		CLIENT AS 'CLIENT',
		CASE ALLOWED 
			WHEN 0 THEN 'NOT ALLOWED'
			WHEN 1 THEN 'ALLOWED'
		END AS 'ALLOWED',
		CLIENT_TYPE AS 'CLIENT TYPE',
		PROMPT_COUNT AS 'PROMPT COUNT',
		INDIRECT_OBJECT_IDENTIFIER AS 'INDIRECT OBJECT IDENTIFIER'
	FROM ACCESS
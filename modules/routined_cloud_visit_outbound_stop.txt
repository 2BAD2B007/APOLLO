[Module Metadata]
AUTHOR=Sarah Edwards/mac4n6.com/@iamevltwin
MODULE_NOTES=Significant Locations - Outbound Stop (Historical)

[Database Metadata]
DATABASE=Cloud.sqlite,Cloud-V2.sqlite
PLATFORMS=IOS
VERSIONS=11,12,13

[Query Metadata]
QUERY_NAME=routined_cloud_visit_outbound_stop
ACTIVITY=Location
KEY_TIMESTAMP=OUTBOUND STOP DATE

[SQL Query 13]
QUERY=
	SELECT
		DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTARTDATE + 978307200, 'unixepoch') AS "OUTBOUND START DATE",
		DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTOPDATE + 978307200, 'unixepoch') AS "OUTBOUND STOP DATE",
		ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
		ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
		ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
		ZRTADDRESSMO.ZCOUNTRY,
		ZRTADDRESSMO.ZCOUNTRYCODE,
		ZRTADDRESSMO.ZPOSTALCODE,
		ZRTADDRESSMO.ZLOCALITY,
		ZRTADDRESSMO.ZSUBLOCALITY,
		ZRTADDRESSMO.ZSUBTHOROUGHFARE,
		ZRTADDRESSMO.ZTHOROUGHFARE,
		ZRTADDRESSMO.ZSUBADMINISTRATIVEAREA,  
		ZRTADDRESSMO.ZAREASOFINTEREST,
		ZRTADDRESSMO.ZOCEAN,
		ZRTADDRESSMO.ZINLANDWATER,
		ZRTADDRESSMO.ZISLAND,
		ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
		ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
		DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
		DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
		DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
		DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
		ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
		ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
		ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
		DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
		DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
		DATETIME(ZRTADDRESSMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "ADDRESS CREATION",	
		ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
		ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
		ZRTMAPITEMMO.ZLATITUDE || ", " || ZRTMAPITEMMO.ZLONGITUDE AS "MAP ITEM COORDINATES",
		DATETIME(ZRTMAPITEMMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION DATE",
		DATETIME(ZRTMAPITEMMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM EXPIRATION DATE",
		ZRTMAPITEMMO.ZLATITUDE AS "MAP ITEM LATITUTE",
		ZRTMAPITEMMO.ZLONGITUDE AS "MAP ITEM LONGITUDE",
		ZRTMAPITEMMO.ZUNCERTAINTY,
		ZRTMAPITEMMO.ZDISPLAYLANGUAGE AS "MAP ITEM LANGUAGE",
		ZRTMAPITEMMO.ZNAME AS "MAP ITEM NAME",
		HEX(ZRTMAPITEMMO.ZGEOMAPITEMHANDLE) AS "MAP ITEM GEOMAPITEM (HEX PROTOBUF)",
		ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID" 
	FROM
	   ZRTLEARNEDVISITMO 
		LEFT JOIN
			ZRTDEVICEMO ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK 
		LEFT JOIN
			ZRTLEARNEDPLACEMO ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE 
		LEFT JOIN
			ZRTLEARNEDTRANSITIONMO ON ZRTLEARNEDTRANSITIONMO.Z_PK = ZRTLEARNEDVISITMO.ZINBOUND
		LEFT JOIN
		ZRTADDRESSMO ON ZRTADDRESSMO.ZMAPITEM = ZRTLEARNEDPLACEMO.ZMAPITEM
			 LEFT JOIN
         ZRTMAPITEMMO ON ZRTMAPITEMMO.Z_PK = ZRTLEARNEDPLACEMO.ZMAPITEM
	WHERE "OUTBOUND STOP DATE" NOT NULL

[SQL Query 12]
QUERY=
	SELECT
		DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTARTDATE + 978307200, 'unixepoch') AS "OUTBOUND START DATE",
		DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTOPDATE + 978307200, 'unixepoch') AS "OUTBOUND STOP DATE",
		ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
		ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
		ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
		ZRTADDRESSMO.ZCOUNTRY,
		ZRTADDRESSMO.ZCOUNTRYCODE,
		ZRTADDRESSMO.ZPOSTALCODE,
		ZRTADDRESSMO.ZLOCALITY,
		ZRTADDRESSMO.ZSUBLOCALITY,
		ZRTADDRESSMO.ZSUBTHOROUGHFARE,
		ZRTADDRESSMO.ZTHOROUGHFARE,
		ZRTADDRESSMO.ZSUBADMINISTRATIVEAREA,  
		ZRTADDRESSMO.ZAREASOFINTEREST,
		ZRTADDRESSMO.ZOCEAN,
		ZRTADDRESSMO.ZINLANDWATER,
		ZRTADDRESSMO.ZISLAND,
		ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
		ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
		DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
		DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
		DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
		DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
		ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
		ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
		ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
		DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
		DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
		DATETIME(ZRTADDRESSMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "ADDRESS CREATION",	
		ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
		ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
		ZRTMAPITEMMO.ZLATITUDE || ", " || ZRTMAPITEMMO.ZLONGITUDE AS "MAP ITEM COORDINATES",
		DATETIME(ZRTMAPITEMMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION DATE",
		DATETIME(ZRTMAPITEMMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM EXPIRATION DATE",
		ZRTMAPITEMMO.ZLATITUDE AS "MAP ITEM LATITUTE",
		ZRTMAPITEMMO.ZLONGITUDE AS "MAP ITEM LONGITUDE",
		ZRTMAPITEMMO.ZUNCERTAINTY,
		ZRTMAPITEMMO.ZNAME AS "MAP ITEM NAME",
		HEX(ZRTMAPITEMMO.ZGEOMAPITEMHANDLE) AS "MAP ITEM GEOMAPITEM (HEX PROTOBUF)",
		ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID" 
	FROM
	   ZRTLEARNEDVISITMO 
		LEFT JOIN
			ZRTDEVICEMO ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK 
		LEFT JOIN
			ZRTLEARNEDPLACEMO ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE 
		LEFT JOIN
			ZRTLEARNEDTRANSITIONMO ON ZRTLEARNEDTRANSITIONMO.Z_PK = ZRTLEARNEDVISITMO.ZINBOUND
		LEFT JOIN
		ZRTADDRESSMO ON ZRTADDRESSMO.ZMAPITEM = ZRTLEARNEDPLACEMO.ZMAPITEM
			 LEFT JOIN
         ZRTMAPITEMMO ON ZRTMAPITEMMO.Z_PK = ZRTLEARNEDPLACEMO.ZMAPITEM
	WHERE "OUTBOUND STOP DATE" NOT NULL

[SQL Query 11]
QUERY=
	SELECT
	   DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTARTDATE + 978307200, 'unixepoch') AS "OUTBOUND START DATE",
	   DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTOPDATE + 978307200, 'unixepoch') AS "OUTBOUND STOP DATE",
	   ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	   ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
	   ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
	   ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
	   ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
	   DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
	   DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
	   DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
	   DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
	   ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
	   ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
	   ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
	   DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
	   DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
	   DATETIME(ZRTLEARNEDPLACEMO.ZMAPITEMCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION",
	   HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	   HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	   ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
	   ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
	   ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID" 
	FROM
	   ZRTLEARNEDVISITMO 
	   LEFT JOIN
	      ZRTDEVICEMO 
	      ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK 
	   LEFT JOIN
	      ZRTLEARNEDPLACEMO 
	      ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE 
	   LEFT JOIN
	      ZRTLEARNEDTRANSITIONMO 
	      ON ZRTLEARNEDTRANSITIONMO.Z_PK = ZRTLEARNEDVISITMO.ZOUTBOUND
      WHERE "OUTBOUND STOP DATE" NOT NULL